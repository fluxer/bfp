<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
"http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
    <!-- Only root can own the service -->
    <policy user="root">
        <allow own="org.powerd.PowerD"/>
        <allow own="org.powerd.Interface"/>
    </policy>

    <!-- Allow only specific group to invoke methods -->
    <policy group="power">
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Reboot"/>
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Shutdown"/>
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Suspend"/>
    </policy>

    <policy group="disk">
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Mount"/>
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Unmount"/>
    </policy>

    <policy group="wheel">
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Ping"/>
        <allow send_destination="org.powerd.PowerD"
            send_interface="org.powerd.Interface"
            send_member="Exit"/>
    </policy>

    <policy context="default">
        <allow send_destination="org.powerd.PowerD"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    </policy>
</busconfig>

