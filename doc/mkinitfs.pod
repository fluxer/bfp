=head1 NAME

mkinitfs - MkInitfs

=head1 SYNOPSIS

    mkinitfs [-h] [-T] [-t TMP] [-b BUSYBOX] [-k KERNEL]
        [-m MODULES [MODULES ...]] [-i IMAGE] [-c {cat,gzip,bzip2}]
        [-r {True,False}] [--keep] [--debug] [--version]

=head1 DESCRIPTION

MkInitfs is a initial RAM filesystem image creator. It relies solely on Busybox
(unless you use filesystem that is not supported by Busybox's fsck, in which
case you will need e2fsprogs too) so you will need a beefy build of it with as
much features as possible. Most vendors do not ship Busybox that can meat the
requirements so make sure you use the test option to confirm it can be used for
the purpose of this tool. An example configuration file for it should be
installed in @DOCDIR@/bfp.

The good thing about it is that you do not have to patch GRUB to get it to
detect the RAM filesystem image created by this tool, unlike many other tools
out there with the same goal. The other thing is that the implementation is
dead simple (from users perspective) - a few files to control the modules and
files that will be included in the image along with hooks support for special
needs such as encrypted partitions.

=head1 OPTIONS

optional arguments:
  -h, --help            Show this help message and exit
  -T, --busytest        Test whether Busybox supports requried functionality
  -t TMP, --tmp TMP     Change temporary directory
  -b BUSYBOX, --busybox BUSYBOX
                        Change busybox binary
  -k KERNEL, --kernel KERNEL
                        Change kernel version
  -m MODULES [MODULES ...], --modules MODULES [MODULES ...]
                        Change modules
  -i IMAGE, --image IMAGE
                        Change output image
  -c {cat,gzip,bzip2}, --compression {cat,gzip,bzip2}
                        Change image compression method
  -r {True,False}, --recovery {True,False}
                        Change wheather to create recovery image
  --keep                Keep temporary directory
  --debug               Enable debug messages
  --version             Show MkInitfs version and exit

=head1 EXAMPLES

Create image for currently running kernel:

    mkinitfs

Create image for kernel other than the one running:

    mkinitfs -k=3.12.24

=head1 EXIT STATUS

MkInitfs returns 0 on success and other on failure.

=head2 Unexpected error (1)

This is a general error. Triggered, most likely, by something that MkInitfs is
not able to handle.

=head2 Internal error (2)

This error raises when something important is missing or failed.

=head2 SUBPROCESS (3)

This error raises when a subprocess, such as Git or Bash, failed to
execute a sub-command.

=head2 SHUTIL (4)

This error raises when the module responsible for shell or system
operations fails badly. Its job usually is to copy or remove files and
directories.

=head2 OS (5)

This error raises when the module responsible for system files and
directories information gathering fails badly. Its job usually is to
check if X is file, symbolic link or directory.

=head2 IO (6)

This error raises when there is something wrong with the file/directory
permissions.

=head2 Interupt signal received (7)

This error raises when the user triggers keyboard interrupt via Ctrl+C key
combination.

=head1 BUGS

None

=head1 FILES

/etc/mkinitfs/files/*.conf

/etc/mkinitfs/modules/*.conf

/etc/mkinitfs/root/*

/etc/mkinitfs/root/hooks/*

=head1 AUTHORS

Ivailo Monev (a.k.a. SmiL3y) <xakepa10@laimg.moc>

Copyright (c) 2012-2017 Ivailo Monev licensed through custom license, see the
COPYING file bundled with the source code.

=head1 SEE ALSO

lsinitfs(8) scanelf(1) gzip(1) cpio(1) modprobe(8)
